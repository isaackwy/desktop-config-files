#!/bin/sh

# This script uses wego to display the weather:
# https://github.com/schachmat/wego

# This script also requires kitty (terminal) and jq

# Terminal command (for spawning wego window) taken from the following source: 
# https://askubuntu.com/questions/20330/how-to-run-a-script-without-closing-the-terminal

CONDITION=$(wego -f json \
  | jq '.Current.Desc' \
  | tr -d '""' \
  | sed "s/overcast clouds/overcast/g" \
  | sed "s/scattered clouds/scattered/g" \
  | sed "s/broken clouds/broken/g" \
  | sed -E "s/[[:alnum:]_'-]+/\u&/g")

WEATHER=$(wego -f markdown \
  | sed -n '4p' \
  | xargs \
  | sed -e 's/ ([^()]*) //g')

case $BLOCK_BUTTON in
    1) kitty -- bash -ic "wego; read -n 1" ;;
    3) notify-send "Û∞ñê Weather module" "\- Left click to display weather." ;;
esac

echo "^b#96cdfb^^c#161320^ $WEATHER $CONDITION"
